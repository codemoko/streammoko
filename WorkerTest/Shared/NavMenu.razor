@using Microsoft.AspNetCore.Components.Authorization
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication

@inject NavigationManager Navigation
@inject SignOutSessionStateManager SignOutManager


<MudAppBar Dense="true">
    <MudImage Width="100" Height="23" Src="MOKO.png" Alt="Mony the dog" Elevation="25" />
    <MudSpacer />
    <MudGrid Spacing="2">
        @foreach (string[] link in Links)
        {
            <MudItem>
                <NavLink href="@link[0]">@link[1]</NavLink>
            </MudItem>
        }
    </MudGrid>
    <MudSpacer />
    <AuthorizeView>
        <Authorized>
            Hello, @context.User.Identity.Name!
            <NavLink href="#" @onclick="BeginSignOut">Log out</NavLink>
        </Authorized>
        <NotAuthorized>
            <NavLink href="authentication/login">Log in</NavLink>
        </NotAuthorized>
    </AuthorizeView>
</MudAppBar>

@code {
    [Parameter] public List<string[]> Links { get; set; } = new List<string[]> { };

    private async Task BeginSignOut(MouseEventArgs args)
    {
        await SignOutManager.SetSignOutState();
        Navigation.NavigateTo("authentication/logout");
    }
}